# docker-compose.override.yml
# Automatically loaded in local development (docker compose up)
# NOT loaded in CI or with explicit -f flags
#
# Development-specific overrides:
# - Bind mounts for hot-reload
# - Direct port access (bypassing Traefik)
# - Debug logging and access logs

services:
  calc:
    volumes:
      - ./services/calc/calc:/app/calc
    environment:
      - FLASK_DEBUG=1

  database:
    volumes:
      - ./services/database/database:/app/database
    environment:
      - FLASK_DEBUG=1
    ports:
      - "5001:5000"  # Direct access for debugging

  fileshare:
    volumes:
      - ./services/fileshare/fileshare:/app/fileshare
    environment:
      - FLASK_DEBUG=1
    ports:
      - "5002:5000"  # Direct access for debugging

  neo4j:
    ports:
      - "${NEO4J_HTTP_PORT:-7474}:7474"  # Browser UI
      - "${NEO4J_BOLT_PORT:-7687}:7687"  # Bolt protocol

  traefik:
    command:
      - "--api.insecure=true"
      - "--providers.docker=true"
      - "--providers.docker.exposedbydefault=false"
      - "--entrypoints.web.address=:80"
      - "--log.level=${TRAEFIK_LOG_LEVEL:-DEBUG}"
      - "--accesslog=true"  # HTTP request logging
      - "--ping=true"
